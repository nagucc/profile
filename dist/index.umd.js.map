{"version":3,"file":"index.umd.js","sources":["../src/Profile-mongo.js","../src/mongo-express-middlewares.js"],"sourcesContent":["/*\n根据微信企业号的userid记录用户的相关信息\n字段包括：_id, userid, roles, name, isMale, phone\n */\n\nimport { useCollection } from 'mongo-use-collection';\n\n\nexport default class Profle {\n  constructor(url, collection = 'profles') {\n    this.useProfiles = cb => useCollection(url, collection, cb);\n  }\n\n  /*\n  添加profile\n   */\n  add(profile = {}) {\n    return new Promise((resolve, reject) =>\n      this.useProfiles(async col => {\n        try {\n          const result = await col.insertOne(profile);\n          resolve(result);\n        } catch (e) {\n          reject(e);\n        }\n      }));\n  }\n  getByUserId(userid) {\n    return new Promise((resolve, reject) =>\n      this.useProfiles(async col => {\n        try {\n          const doc = await col.findOne({ userid });\n          resolve(doc);\n        } catch (e) {\n          reject(e);\n        }\n      }));\n  }\n  get(_id) {\n    return new Promise((resolve, reject) =>\n      this.useProfiles(async col => {\n        try {\n          const doc = await col.findOne({ _id });\n          resolve(doc);\n        } catch (e) {\n          reject(e);\n        }\n      }));\n  }\n  findOne(query) {\n    return new Promise((resolve, reject) =>\n      this.useProfiles(async col => {\n        try {\n          const doc = await col.findOne(query);\n          resolve(doc);\n        } catch (e) {\n          reject(e);\n        }\n      }));\n  }\n  update(_id, profile = {}) {\n    return new Promise((resolve, reject) =>\n      this.useProfiles(async col => {\n        try {\n          const oldDoc = await this.get(_id);\n          const doc = {\n            ...oldDoc,\n            ...profile,\n          };\n          await col.updateOne({ _id }, { $set: doc });\n          resolve(doc);\n        } catch (e) {\n          reject(e);\n        }\n      }));\n  }\n  remove(_id) {\n    return new Promise((resolve, reject) =>\n      this.useProfiles(async col => {\n        try {\n          const result = await col.remove({ _id });\n          resolve(result);\n        } catch (e) {\n          reject(e);\n        }\n      }));\n  }\n }\n\n// const PROFILE_COLLECTION = 'profiles';\n\n// const dao = new WxeProfle(mongoUrl, PROFILE_COLLECTION);\n// export default dao;\n","/*\neslint-disable no-param-reassign, no-underscore-dangle\n */\nimport { SERVER_FAILED,\n  OBJECT_IS_UNDEFINED_OR_NULL, OBJECT_IS_NOT_FOUND, REQUIRED } from 'nagu-validates';\n\nimport { Profile } from './index';\n\nexport default class MongoProfileMiddlewares {\n  constructor(mongoUrl, collection = 'profiles', getId) {\n    this.mongoUrl = mongoUrl;\n    this.collection = collection;\n    this.getId = getId;\n    this.dao = new Profile(this.mongoUrl, this.collection);\n  }\n  /*\n  添加Profile\n   */\n  add(\n    // 定义获取profile数据的方法，默认取req.body的全部数据\n    composeProfile = req => req.body,\n    // 定义操作成功之后的动作，默认继续指向下一个中间件。\n    success = (profile, req, res, next) => next(),\n    // 定义操作失败之后的动作，默认为输出\n    fail = (err, req, res) => res.send(err),\n  ) {\n    return async (req, res, next) => {\n      try {\n        const profile = composeProfile(req, res);\n        if (!profile.name) {\n          fail({\n            ret: OBJECT_IS_UNDEFINED_OR_NULL,\n            msg: '姓名不能为空',\n          }, req, res, next);\n          return;\n        }\n        const result = await this.dao.add(profile);\n        success({ _id: result.insertedId, ...profile }, req, res, next);\n      } catch (e) {\n        fail({\n          ret: SERVER_FAILED,\n          msg: e,\n        }, req, res, next);\n      }\n    };\n  }\n  // 根据Id获取profile\n  get(\n    // 定义获取Id的方法，默认取url中的id参数\n    getId = req => req.params.id,\n    // 定义操作成功之后的动作，默认继续指向下一个中间件。\n    success = (doc, req, res, next) => next(),\n    // 定义操作失败之后的动作，默认为输出\n    fail = (result, req, res) => res.send(result),\n  ) {\n    return async (req, res, next) => {\n      try {\n        const _id = getId(req, res);\n        if (!_id) {\n          fail({ ret: OBJECT_IS_UNDEFINED_OR_NULL, msg: '必须指定id' }, req, res, next);\n          return;\n        }\n        const doc = await this.dao.get(_id);\n        success(doc, req, res, next);\n      } catch (e) {\n        fail({\n          ret: SERVER_FAILED,\n          msg: e,\n        }, req, res, next);\n      }\n    };\n  }\n\n  findOne(getQuery, success = (doc, req, res, next) => {\n    res.profile = doc;\n    next();\n  }, fail = (result, req, res) => {\n    res.send(result);\n  }) {\n    return async (req, res, next) => {\n      try {\n        const query = getQuery(req, res);\n        const doc = await this.dao.findOne(query);\n        success(doc, req, res, next);\n      } catch (e) {\n        fail({\n          ret: SERVER_FAILED,\n          msg: e,\n        }, req, res, next);\n      }\n    };\n  }\n  update(getId, composeProfile) {\n    return async (req, res, next) => {\n      const _id = getId(req, res);\n      const profile = composeProfile(req, res);\n      try {\n        await this.dao.update(_id, profile);\n        next();\n      } catch (e) {\n        res.send({\n          ret: SERVER_FAILED,\n          msg: e,\n        });\n      }\n    };\n  }\n  remove(getId) {\n    return async (req, res, next) => {\n      const _id = getId(req, res);\n      try {\n        await this.dao.remove(_id);\n        next();\n      } catch (e) {\n        res.send({\n          ret: SERVER_FAILED,\n          msg: e,\n        });\n      }\n    };\n  }\n\n// 判断当前用户是否是指定profile的所有者\n  isOwner(\n    getId = () => null,\n    getCurrentUserId = () => null,\n    success = (result, req, res, next) => next(),\n    fail = (err, req, res) => res.send(err),\n  ) {\n    return async (req, res, next) => {\n      try {\n        const id = getId(req, res);\n        // 确保profile.id不为空\n        if (!id) {\n          fail({ ret: OBJECT_IS_UNDEFINED_OR_NULL, msg: 'profile的Id不能为空' }, req, res, next);\n          return;\n        }\n        const data = await this.dao.get(id);\n        // 确保id正确，能取到数据\n        if (!data) {\n          fail({ ret: OBJECT_IS_NOT_FOUND, msg: '对象不存在' }, req, res, next);\n          return;\n        }\n        const userid = getCurrentUserId(req, res, next);\n        success(userid === data.userid, req, res, next);\n      } catch (e) {\n        fail({\n          ret: SERVER_FAILED,\n          msg: e,\n        }, req, res, next);\n      }\n    };\n  }\n\n  isManager(\n    getCurrentUserId = () => null,\n    managerGroupId,\n    success = (result, req, res, next) => next(),\n    fail = (err, req, res) => res.send(err),\n  ) {\n    return async (req, res, next) => {\n      if (!managerGroupId) {\n        fail({ ret: REQUIRED, msg: '必须提供正确的MangerGroupId' }, req, res, next);\n        return;\n      }\n      const userid = getCurrentUserId(req, res);\n      const profile = await this.dao.getByUserId(userid);\n      let result = false;\n      if (profile.roles && profile.roles.length) {\n        result = profile.roles.some(role => role === managerGroupId);\n      }\n      success(result, req, res, next);\n    };\n  }\n\n  isSupervisor(\n    getCurrentUserId = () => null,\n    supervisorGroupId,\n    success = (result, req, res, next) => next(),\n    fail = (err, req, res) => res.send(err),\n  ) {\n    return async (req, res, next) => {\n      if (!supervisorGroupId) {\n        fail({ ret: REQUIRED, msg: '必须提供正确的SupervisorGroupId' }, req, res, next);\n        return;\n      }\n      const userid = getCurrentUserId(req, res);\n      const profile = await this.dao.getByUserId(userid);\n      let result = false;\n      if (profile.roles && profile.roles.length) {\n        result = profile.roles.some(role => role === supervisorGroupId);\n      }\n      success(result, req, res, next);\n    };\n  }\n}\n"],"names":["useCollection","Profile","OBJECT_IS_UNDEFINED_OR_NULL","SERVER_FAILED","OBJECT_IS_NOT_FOUND","REQUIRED"],"mappings":";;;;;;;;;;;;;MAQqB;AACnB,EAAA,kBAAY,GAAZ,EAAyC;AAAA,EAAA,QAAxB,UAAwB,yDAAX,SAAW;;AAAA,EAAA;;AACvC,EAAA,SAAK,WAAL,GAAmB;AAAA,EAAA,aAAMA,iCAAc,GAAd,EAAmB,UAAnB,EAA+B,EAA/B,CAAN;AAAA,EAAA,KAAnB;AACD,EAAA;;;;;;;;;4BAKiB;AAAA,EAAA;;AAAA,EAAA,UAAd,OAAc,yDAAJ,EAAI;;AAChB,EAAA,aAAO,aAAY,UAAC,OAAD,EAAU,MAAV;AAAA,EAAA,eACjB,MAAK,WAAL;AAAA,EAAA,gEAAiB,iBAAM,GAAN;AAAA,EAAA,gBAEP,MAFO;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA,2BAEQ,IAAI,SAAJ,CAAc,OAAd,CAFR;;AAAA,EAAA;AAEP,EAAA,0BAFO;;AAGb,EAAA,4BAAQ,MAAR;AAHa,EAAA;AAAA,EAAA;;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;;AAKb,EAAA;;AALa,EAAA;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA,WAAjB;;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA,YADiB;AAAA,EAAA,OAAZ,CAAP;AASD,EAAA;;;kCACW,QAAQ;AAAA,EAAA;;AAClB,EAAA,aAAO,aAAY,UAAC,OAAD,EAAU,MAAV;AAAA,EAAA,eACjB,OAAK,WAAL;AAAA,EAAA,iEAAiB,kBAAM,GAAN;AAAA,EAAA,gBAEP,GAFO;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA,2BAEK,IAAI,OAAJ,CAAY,EAAE,cAAF,EAAZ,CAFL;;AAAA,EAAA;AAEP,EAAA,uBAFO;;AAGb,EAAA,4BAAQ,GAAR;AAHa,EAAA;AAAA,EAAA;;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;;AAKb,EAAA;;AALa,EAAA;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA,WAAjB;;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA,YADiB;AAAA,EAAA,OAAZ,CAAP;AASD,EAAA;;;0BACG,KAAK;AAAA,EAAA;;AACP,EAAA,aAAO,aAAY,UAAC,OAAD,EAAU,MAAV;AAAA,EAAA,eACjB,OAAK,WAAL;AAAA,EAAA,iEAAiB,kBAAM,GAAN;AAAA,EAAA,gBAEP,GAFO;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA,2BAEK,IAAI,OAAJ,CAAY,EAAE,QAAF,EAAZ,CAFL;;AAAA,EAAA;AAEP,EAAA,uBAFO;;AAGb,EAAA,4BAAQ,GAAR;AAHa,EAAA;AAAA,EAAA;;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;;AAKb,EAAA;;AALa,EAAA;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA,WAAjB;;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA,YADiB;AAAA,EAAA,OAAZ,CAAP;AASD,EAAA;;;8BACO,OAAO;AAAA,EAAA;;AACb,EAAA,aAAO,aAAY,UAAC,OAAD,EAAU,MAAV;AAAA,EAAA,eACjB,OAAK,WAAL;AAAA,EAAA,iEAAiB,kBAAM,GAAN;AAAA,EAAA,gBAEP,GAFO;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA,2BAEK,IAAI,OAAJ,CAAY,KAAZ,CAFL;;AAAA,EAAA;AAEP,EAAA,uBAFO;;AAGb,EAAA,4BAAQ,GAAR;AAHa,EAAA;AAAA,EAAA;;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;;AAKb,EAAA;;AALa,EAAA;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA,WAAjB;;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA,YADiB;AAAA,EAAA,OAAZ,CAAP;AASD,EAAA;;;6BACM,KAAmB;AAAA,EAAA;;AAAA,EAAA,UAAd,OAAc,yDAAJ,EAAI;;AACxB,EAAA,aAAO,aAAY,UAAC,OAAD,EAAU,MAAV;AAAA,EAAA,eACjB,OAAK,WAAL;AAAA,EAAA,iEAAiB,kBAAM,GAAN;AAAA,EAAA,gBAEP,MAFO,EAGP,GAHO;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA,2BAEQ,OAAK,GAAL,CAAS,GAAT,CAFR;;AAAA,EAAA;AAEP,EAAA,0BAFO;AAGP,EAAA,uBAHO,gBAIR,MAJQ,EAKR,OALQ;AAAA,EAAA;AAAA,EAAA,2BAOP,IAAI,SAAJ,CAAc,EAAE,QAAF,EAAd,EAAuB,EAAE,MAAM,GAAR,EAAvB,CAPO;;AAAA,EAAA;AAQb,EAAA,4BAAQ,GAAR;AARa,EAAA;AAAA,EAAA;;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;;AAUb,EAAA;;AAVa,EAAA;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA,WAAjB;;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA,YADiB;AAAA,EAAA,OAAZ,CAAP;AAcD,EAAA;;;6BACM,KAAK;AAAA,EAAA;;AACV,EAAA,aAAO,aAAY,UAAC,OAAD,EAAU,MAAV;AAAA,EAAA,eACjB,OAAK,WAAL;AAAA,EAAA,iEAAiB,kBAAM,GAAN;AAAA,EAAA,gBAEP,MAFO;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA,2BAEQ,IAAI,MAAJ,CAAW,EAAE,QAAF,EAAX,CAFR;;AAAA,EAAA;AAEP,EAAA,0BAFO;;AAGb,EAAA,4BAAQ,MAAR;AAHa,EAAA;AAAA,EAAA;;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;;AAKb,EAAA;;AALa,EAAA;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA,WAAjB;;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA,YADiB;AAAA,EAAA,OAAZ,CAAP;AASD,EAAA;;;;;;MC9EkB;AACnB,EAAA,mCAAY,QAAZ,EAAsD;AAAA,EAAA,QAAhC,UAAgC,yDAAnB,UAAmB;AAAA,EAAA,QAAP,KAAO;;AAAA,EAAA;;AACpD,EAAA,SAAK,QAAL,GAAgB,QAAhB;AACA,EAAA,SAAK,UAAL,GAAkB,UAAlB;AACA,EAAA,SAAK,KAAL,GAAa,KAAb;AACA,EAAA,SAAK,GAAL,GAAW,IAAIC,MAAJ,CAAY,KAAK,QAAjB,EAA2B,KAAK,UAAhC,CAAX;AACD,EAAA;;;;;;;;4BAWC;AAAA,EAAA,UALA,cAKA,yDALiB;AAAA,EAAA,eAAO,IAAI,IAAX;AAAA,EAAA,OAKjB;;AAAA,EAAA;;AAAA,EAAA,UAHA,OAGA,yDAHU,UAAC,OAAD,EAAU,GAAV,EAAe,GAAf,EAAoB,IAApB;AAAA,EAAA,eAA6B,MAA7B;AAAA,EAAA,OAGV;AAAA,EAAA,UADA,IACA,yDADO,UAAC,GAAD,EAAM,GAAN,EAAW,GAAX;AAAA,EAAA,eAAmB,IAAI,IAAJ,CAAS,GAAT,CAAnB;AAAA,EAAA,OACP;;AACA,EAAA;AAAA,EAAA,8DAAO,iBAAO,GAAP,EAAY,GAAZ,EAAiB,IAAjB;AAAA,EAAA,cAEG,OAFH,EAUG,MAVH;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;AAEG,EAAA,yBAFH,GAEa,eAAe,GAAf,EAAoB,GAApB,CAFb;;AAAA,EAAA,sBAGE,QAAQ,IAHV;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;;AAID,EAAA,uBAAK;AACH,EAAA,yBAAKC,yCADF;AAEH,EAAA,yBAAK;AAFF,EAAA,mBAAL,EAGG,GAHH,EAGQ,GAHR,EAGa,IAHb;AAJC,EAAA;;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA,yBAUkB,MAAK,GAAL,CAAS,GAAT,CAAa,OAAb,CAVlB;;AAAA,EAAA;AAUG,EAAA,wBAVH;;AAWH,EAAA,qCAAU,KAAK,OAAO,UAAtB,IAAqC,OAArC,GAAgD,GAAhD,EAAqD,GAArD,EAA0D,IAA1D;AAXG,EAAA;AAAA,EAAA;;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;;AAaH,EAAA,uBAAK;AACH,EAAA,yBAAKC,2BADF;AAEH,EAAA;AAFG,EAAA,mBAAL,EAGG,GAHH,EAGQ,GAHR,EAGa,IAHb;;AAbG,EAAA;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA,SAAP;;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;AAmBD,EAAA;;;;;4BASC;AAAA,EAAA,UALA,KAKA,yDALQ;AAAA,EAAA,eAAO,IAAI,MAAJ,CAAW,EAAlB;AAAA,EAAA,OAKR;;AAAA,EAAA;;AAAA,EAAA,UAHA,OAGA,yDAHU,UAAC,GAAD,EAAM,GAAN,EAAW,GAAX,EAAgB,IAAhB;AAAA,EAAA,eAAyB,MAAzB;AAAA,EAAA,OAGV;AAAA,EAAA,UADA,IACA,yDADO,UAAC,MAAD,EAAS,GAAT,EAAc,GAAd;AAAA,EAAA,eAAsB,IAAI,IAAJ,CAAS,MAAT,CAAtB;AAAA,EAAA,OACP;;AACA,EAAA;AAAA,EAAA,+DAAO,kBAAO,GAAP,EAAY,GAAZ,EAAiB,IAAjB;AAAA,EAAA,cAEG,GAFH,EAOG,GAPH;;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;AAEG,EAAA,qBAFH,GAES,MAAM,GAAN,EAAW,GAAX,CAFT;;AAAA,EAAA,sBAGE,GAHF;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;;AAID,EAAA,uBAAK,EAAE,KAAKD,yCAAP,EAAoC,KAAK,QAAzC,EAAL,EAA0D,GAA1D,EAA+D,GAA/D,EAAoE,IAApE;AAJC,EAAA;;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA,yBAOe,OAAK,GAAL,CAAS,GAAT,CAAa,GAAb,CAPf;;AAAA,EAAA;AAOG,EAAA,qBAPH;;AAQH,EAAA,0BAAQ,GAAR,EAAa,GAAb,EAAkB,GAAlB,EAAuB,IAAvB;AARG,EAAA;AAAA,EAAA;;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;;AAUH,EAAA,uBAAK;AACH,EAAA,yBAAKC,2BADF;AAEH,EAAA;AAFG,EAAA,mBAAL,EAGG,GAHH,EAGQ,GAHR,EAGa,IAHb;;AAVG,EAAA;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA,SAAP;;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;AAgBD,EAAA;;;8BAEO,UAKL;AAAA,EAAA;;AAAA,EAAA,UALe,OAKf,yDALyB,UAAC,GAAD,EAAM,GAAN,EAAW,GAAX,EAAgB,IAAhB,EAAyB;AACnD,EAAA,YAAI,OAAJ,GAAc,GAAd;AACA,EAAA;AACD,EAAA,OAEE;AAAA,EAAA,UAFA,IAEA,yDAFO,UAAC,MAAD,EAAS,GAAT,EAAc,GAAd,EAAsB;AAC9B,EAAA,YAAI,IAAJ,CAAS,MAAT;AACD,EAAA,OAAE;;AACD,EAAA;AAAA,EAAA,+DAAO,kBAAO,GAAP,EAAY,GAAZ,EAAiB,IAAjB;AAAA,EAAA,cAEG,KAFH,EAGG,GAHH;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;AAEG,EAAA,uBAFH,GAEW,SAAS,GAAT,EAAc,GAAd,CAFX;AAAA,EAAA;AAAA,EAAA,yBAGe,OAAK,GAAL,CAAS,OAAT,CAAiB,KAAjB,CAHf;;AAAA,EAAA;AAGG,EAAA,qBAHH;;AAIH,EAAA,0BAAQ,GAAR,EAAa,GAAb,EAAkB,GAAlB,EAAuB,IAAvB;AAJG,EAAA;AAAA,EAAA;;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;;AAMH,EAAA,uBAAK;AACH,EAAA,yBAAKA,2BADF;AAEH,EAAA;AAFG,EAAA,mBAAL,EAGG,GAHH,EAGQ,GAHR,EAGa,IAHb;;AANG,EAAA;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA,SAAP;;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;AAYD,EAAA;;;6BACM,OAAO,gBAAgB;AAAA,EAAA;;AAC5B,EAAA;AAAA,EAAA,+DAAO,kBAAO,GAAP,EAAY,GAAZ,EAAiB,IAAjB;AAAA,EAAA,cACC,GADD,EAEC,OAFD;;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;AACC,EAAA,qBADD,GACO,MAAM,GAAN,EAAW,GAAX,CADP;AAEC,EAAA,yBAFD,GAEW,eAAe,GAAf,EAAoB,GAApB,CAFX;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA,yBAIG,OAAK,GAAL,CAAS,MAAT,CAAgB,GAAhB,EAAqB,OAArB,CAJH;;AAAA,EAAA;AAKH,EAAA;AALG,EAAA;AAAA,EAAA;;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;;AAOH,EAAA,sBAAI,IAAJ,CAAS;AACP,EAAA,yBAAKA,2BADE;AAEP,EAAA;AAFO,EAAA,mBAAT;;AAPG,EAAA;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA,SAAP;;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;AAaD,EAAA;;;6BACM,OAAO;AAAA,EAAA;;AACZ,EAAA;AAAA,EAAA,+DAAO,kBAAO,GAAP,EAAY,GAAZ,EAAiB,IAAjB;AAAA,EAAA,cACC,GADD;;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;AACC,EAAA,qBADD,GACO,MAAM,GAAN,EAAW,GAAX,CADP;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA,yBAGG,OAAK,GAAL,CAAS,MAAT,CAAgB,GAAhB,CAHH;;AAAA,EAAA;AAIH,EAAA;AAJG,EAAA;AAAA,EAAA;;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;;AAMH,EAAA,sBAAI,IAAJ,CAAS;AACP,EAAA,yBAAKA,2BADE;AAEP,EAAA;AAFO,EAAA,mBAAT;;AANG,EAAA;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA,SAAP;;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;AAYD,EAAA;;;;;;gCAQC;AAAA,EAAA,UAJA,KAIA,yDAJQ;AAAA,EAAA,eAAM,IAAN;AAAA,EAAA,OAIR;AAAA,EAAA,UAHA,gBAGA,yDAHmB;AAAA,EAAA,eAAM,IAAN;AAAA,EAAA,OAGnB;;AAAA,EAAA;;AAAA,EAAA,UAFA,OAEA,yDAFU,UAAC,MAAD,EAAS,GAAT,EAAc,GAAd,EAAmB,IAAnB;AAAA,EAAA,eAA4B,MAA5B;AAAA,EAAA,OAEV;AAAA,EAAA,UADA,IACA,yDADO,UAAC,GAAD,EAAM,GAAN,EAAW,GAAX;AAAA,EAAA,eAAmB,IAAI,IAAJ,CAAS,GAAT,CAAnB;AAAA,EAAA,OACP;;AACA,EAAA;AAAA,EAAA,+DAAO,kBAAO,GAAP,EAAY,GAAZ,EAAiB,IAAjB;AAAA,EAAA,cAEG,EAFH,EAQG,IARH,EAcG,MAdH;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;AAEG,EAAA,oBAFH,GAEQ,MAAM,GAAN,EAAW,GAAX,CAFR;;;AAAA,EAAA,sBAIE,EAJF;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;;AAKD,EAAA,uBAAK,EAAE,KAAKD,yCAAP,EAAoC,KAAK,gBAAzC,EAAL,EAAkE,GAAlE,EAAuE,GAAvE,EAA4E,IAA5E;AALC,EAAA;;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA,yBAQgB,OAAK,GAAL,CAAS,GAAT,CAAa,EAAb,CARhB;;AAAA,EAAA;AAQG,EAAA,sBARH;;AAAA,EAAA,sBAUE,IAVF;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;;AAWD,EAAA,uBAAK,EAAE,KAAKE,iCAAP,EAA4B,KAAK,OAAjC,EAAL,EAAiD,GAAjD,EAAsD,GAAtD,EAA2D,IAA3D;AAXC,EAAA;;AAAA,EAAA;AAcG,EAAA,wBAdH,GAcY,iBAAiB,GAAjB,EAAsB,GAAtB,EAA2B,IAA3B,CAdZ;;AAeH,EAAA,0BAAQ,WAAW,KAAK,MAAxB,EAAgC,GAAhC,EAAqC,GAArC,EAA0C,IAA1C;AAfG,EAAA;AAAA,EAAA;;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;;AAiBH,EAAA,uBAAK;AACH,EAAA,yBAAKD,2BADF;AAEH,EAAA;AAFG,EAAA,mBAAL,EAGG,GAHH,EAGQ,GAHR,EAGa,IAHb;;AAjBG,EAAA;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA,SAAP;;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;AAuBD,EAAA;;;kCAOC;AAAA,EAAA,UAJA,gBAIA,yDAJmB;AAAA,EAAA,eAAM,IAAN;AAAA,EAAA,OAInB;AAAA,EAAA,UAHA,cAGA;;AAAA,EAAA;;AAAA,EAAA,UAFA,OAEA,yDAFU,UAAC,MAAD,EAAS,GAAT,EAAc,GAAd,EAAmB,IAAnB;AAAA,EAAA,eAA4B,MAA5B;AAAA,EAAA,OAEV;AAAA,EAAA,UADA,IACA,yDADO,UAAC,GAAD,EAAM,GAAN,EAAW,GAAX;AAAA,EAAA,eAAmB,IAAI,IAAJ,CAAS,GAAT,CAAnB;AAAA,EAAA,OACP;;AACA,EAAA;AAAA,EAAA,+DAAO,kBAAO,GAAP,EAAY,GAAZ,EAAiB,IAAjB;AAAA,EAAA,cAKC,MALD,EAMC,OAND,EAOD,MAPC;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA,sBACA,cADA;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;;AAEH,EAAA,uBAAK,EAAE,KAAKE,sBAAP,EAAiB,KAAK,sBAAtB,EAAL,EAAqD,GAArD,EAA0D,GAA1D,EAA+D,IAA/D;AAFG,EAAA;;AAAA,EAAA;AAKC,EAAA,wBALD,GAKU,iBAAiB,GAAjB,EAAsB,GAAtB,CALV;AAAA,EAAA;AAAA,EAAA,yBAMiB,OAAK,GAAL,CAAS,WAAT,CAAqB,MAArB,CANjB;;AAAA,EAAA;AAMC,EAAA,yBAND;AAOD,EAAA,wBAPC,GAOQ,KAPR;;AAQL,EAAA,sBAAI,QAAQ,KAAR,IAAiB,QAAQ,KAAR,CAAc,MAAnC,EAA2C;AACzC,EAAA,6BAAS,QAAQ,KAAR,CAAc,IAAd,CAAmB;AAAA,EAAA,6BAAQ,SAAS,cAAjB;AAAA,EAAA,qBAAnB,CAAT;AACD,EAAA;AACD,EAAA,0BAAQ,MAAR,EAAgB,GAAhB,EAAqB,GAArB,EAA0B,IAA1B;;AAXK,EAAA;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA,SAAP;;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;AAaD,EAAA;;;qCAOC;AAAA,EAAA,UAJA,gBAIA,yDAJmB;AAAA,EAAA,eAAM,IAAN;AAAA,EAAA,OAInB;AAAA,EAAA,UAHA,iBAGA;;AAAA,EAAA;;AAAA,EAAA,UAFA,OAEA,yDAFU,UAAC,MAAD,EAAS,GAAT,EAAc,GAAd,EAAmB,IAAnB;AAAA,EAAA,eAA4B,MAA5B;AAAA,EAAA,OAEV;AAAA,EAAA,UADA,IACA,yDADO,UAAC,GAAD,EAAM,GAAN,EAAW,GAAX;AAAA,EAAA,eAAmB,IAAI,IAAJ,CAAS,GAAT,CAAnB;AAAA,EAAA,OACP;;AACA,EAAA;AAAA,EAAA,+DAAO,kBAAO,GAAP,EAAY,GAAZ,EAAiB,IAAjB;AAAA,EAAA,cAKC,MALD,EAMC,OAND,EAOD,MAPC;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA,sBACA,iBADA;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;;AAEH,EAAA,uBAAK,EAAE,KAAKA,sBAAP,EAAiB,KAAK,0BAAtB,EAAL,EAAyD,GAAzD,EAA8D,GAA9D,EAAmE,IAAnE;AAFG,EAAA;;AAAA,EAAA;AAKC,EAAA,wBALD,GAKU,iBAAiB,GAAjB,EAAsB,GAAtB,CALV;AAAA,EAAA;AAAA,EAAA,yBAMiB,OAAK,GAAL,CAAS,WAAT,CAAqB,MAArB,CANjB;;AAAA,EAAA;AAMC,EAAA,yBAND;AAOD,EAAA,wBAPC,GAOQ,KAPR;;AAQL,EAAA,sBAAI,QAAQ,KAAR,IAAiB,QAAQ,KAAR,CAAc,MAAnC,EAA2C;AACzC,EAAA,6BAAS,QAAQ,KAAR,CAAc,IAAd,CAAmB;AAAA,EAAA,6BAAQ,SAAS,iBAAjB;AAAA,EAAA,qBAAnB,CAAT;AACD,EAAA;AACD,EAAA,0BAAQ,MAAR,EAAgB,GAAhB,EAAqB,GAArB,EAA0B,IAA1B;;AAXK,EAAA;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA,SAAP;;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;AAaD,EAAA;;;;;;;;;;;;;"}