{"version":3,"file":"index.es6.js","sources":["../src/Profile-mongo.js"],"sourcesContent":["/*\n根据微信企业号的userid记录用户的相关信息\n字段包括：_id, userid, roles, name, isMale, phone\n */\n\nimport { useCollection } from 'mongo-use-collection';\n// import { mongoUrl } from '../../config';\n\n\nexport default class Profle {\n  constructor(url, collection = 'profles') {\n    this.useProfiles = cb => useCollection(url, collection, cb);\n  }\n\n  /*\n  添加profile\n   */\n  add(profile = {}) {\n    return new Promise((resolve, reject) =>\n      this.useProfiles(async col => {\n        try {\n          const result = await col.insertOne(profile);\n          resolve(result);\n        } catch (e) {\n          reject(e);\n        }\n      }));\n  }\n  getByUserId(userid) {\n    return new Promise((resolve, reject) =>\n      this.useProfiles(async col => {\n        try {\n          const doc = await col.findOne({ userid });\n          resolve(doc);\n        } catch (e) {\n          reject(e);\n        }\n      }));\n  }\n  get(_id) {\n    return new Promise((resolve, reject) =>\n      this.useProfiles(async col => {\n        try {\n          const doc = await col.findOne({ _id });\n          resolve(doc);\n        } catch (e) {\n          reject(e);\n        }\n      }));\n  }\n  update(_id, profile = {}) {\n    return new Promise((resolve, reject) =>\n      this.useProfiles(async col => {\n        try {\n          const oldDoc = await this.get(_id);\n          const doc = {\n            ...oldDoc,\n            ...profile,\n          };\n          await col.updateOne({ _id }, { $set: doc });\n          resolve(doc);\n        } catch (e) {\n          reject(e);\n        }\n      }));\n  }\n  remove(_id) {\n    return new Promise((resolve, reject) =>\n      this.useProfiles(async col => {\n        try {\n          const result = await col.remove({ _id });\n          resolve(result);\n        } catch (e) {\n          reject(e);\n        }\n      }));\n  }\n }\n\n// const PROFILE_COLLECTION = 'profiles';\n\n// const dao = new WxeProfle(mongoUrl, PROFILE_COLLECTION);\n// export default dao;\n"],"names":[],"mappings":";;;;;;;;;;IASqB;kBACP,GAAZ,EAAyC;QAAxB,UAAwB,yDAAX,SAAW;;;;SAClC,WAAL,GAAmB;aAAM,cAAc,GAAd,EAAmB,UAAnB,EAA+B,EAA/B,CAAN;KAAnB;;;;;;;;;;0BAMgB;;;UAAd,OAAc,yDAAJ,EAAI;;aACT,aAAY,UAAC,OAAD,EAAU,MAAV;eACjB,MAAK,WAAL;gEAAiB,iBAAM,GAAN;gBAEP,MAFO;;;;;;;2BAEQ,IAAI,SAAJ,CAAc,OAAd,CAFR;;;0BAAA;;4BAGL,MAAR;;;;;;;;;;;;;;;;WAHJ;;;;;YADiB;OAAZ,CAAP;;;;gCAUU,QAAQ;;;aACX,aAAY,UAAC,OAAD,EAAU,MAAV;eACjB,OAAK,WAAL;iEAAiB,kBAAM,GAAN;gBAEP,GAFO;;;;;;;2BAEK,IAAI,OAAJ,CAAY,EAAE,cAAF,EAAZ,CAFL;;;uBAAA;;4BAGL,GAAR;;;;;;;;;;;;;;;;WAHJ;;;;;YADiB;OAAZ,CAAP;;;;wBAUE,KAAK;;;aACA,aAAY,UAAC,OAAD,EAAU,MAAV;eACjB,OAAK,WAAL;iEAAiB,kBAAM,GAAN;gBAEP,GAFO;;;;;;;2BAEK,IAAI,OAAJ,CAAY,EAAE,QAAF,EAAZ,CAFL;;;uBAAA;;4BAGL,GAAR;;;;;;;;;;;;;;;;WAHJ;;;;;YADiB;OAAZ,CAAP;;;;2BAUK,KAAmB;;;UAAd,OAAc,yDAAJ,EAAI;;aACjB,aAAY,UAAC,OAAD,EAAU,MAAV;eACjB,OAAK,WAAL;iEAAiB,kBAAM,GAAN;gBAEP,MAFO,EAGP,GAHO;;;;;;;2BAEQ,OAAK,GAAL,CAAS,GAAT,CAFR;;;0BAAA;uBAAA,gBAIR,MAJQ,EAKR,OALQ;;2BAOP,IAAI,SAAJ,CAAc,EAAE,QAAF,EAAd,EAAuB,EAAE,MAAM,GAAR,EAAvB,CAPO;;;4BAQL,GAAR;;;;;;;;;;;;;;;;WARJ;;;;;YADiB;OAAZ,CAAP;;;;2BAeK,KAAK;;;aACH,aAAY,UAAC,OAAD,EAAU,MAAV;eACjB,OAAK,WAAL;iEAAiB,kBAAM,GAAN;gBAEP,MAFO;;;;;;;2BAEQ,IAAI,MAAJ,CAAW,EAAE,QAAF,EAAX,CAFR;;;0BAAA;;4BAGL,MAAR;;;;;;;;;;;;;;;;WAHJ;;;;;YADiB;OAAZ,CAAP;;;;;;;"}